A Quick System Audit Script

Results of date command:
Mon Mar 14 21:44:45 EDT 2022

Results of uname -a command:
Linux UbuntuDesktop 5.4.0-99-generic #112~18.04.1-Ubuntu SMP Thu Feb 3 14:09:57 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux

Results of hostname -s command:
UbuntuDesktop

Machine Type Info:
x86_64-pc-linux-gnu 

IP Address Info:
    inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute enp0s3
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0 

DNS Servers: 
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
# 127.0.0.53 is the systemd-resolved stub resolver.
# run "systemd-resolve --status" to see details about the actual nameservers.

nameserver 8.8.8.8
nameserver 127.0.0.53

Memory Info: 
              total        used        free      shared  buff/cache   available
Mem:        4026128     1223632      292488       44156     2510008     2477684
Swap:       1958148           0     1958148

CPU Info:
CPU op-mode(s):      32-bit, 64-bit
CPU(s):              2
On-line CPU(s) list: 0,1
CPU family:          6
CPU MHz:             2304.000
NUMA node0 CPU(s):   0,1

Disk Usage:
Filesystem      Size  Used Avail Use% Mounted on
udev            2.1G     0  2.1G   0% /dev

Who is logged in: 
 sysadmin :0           2022-03-14 21:39 (:0) 

User adam is not allowed to run sudo on UbuntuDesktop.
User badguy is not allowed to run sudo on UbuntuDesktop.
User billy is not allowed to run sudo on UbuntuDesktop.
User http is not allowed to run sudo on UbuntuDesktop.
Matching Defaults entries for instructor on UbuntuDesktop:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User instructor may run the following commands on UbuntuDesktop:
    (ALL : ALL) ALL
User jane is not allowed to run sudo on UbuntuDesktop.
User john is not allowed to run sudo on UbuntuDesktop.
User max is not allowed to run sudo on UbuntuDesktop.
User sally is not allowed to run sudo on UbuntuDesktop.
Matching Defaults entries for student on UbuntuDesktop:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User student may run the following commands on UbuntuDesktop:
    (ALL : ALL) ALL
Matching Defaults entries for sysadmin on UbuntuDesktop:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User sysadmin may run the following commands on UbuntuDesktop:
    (ALL : ALL) ALL
Matching Defaults entries for vagrant on UbuntuDesktop:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User vagrant may run the following commands on UbuntuDesktop:
    (ALL : ALL) NOPASSWD: ALL

SUID Files:
/opt/google/chrome/chrome-sandbox
/opt/BurpSuiteCommunity/burpbrowser/87.0.4280.66/chrome-sandbox
/var/lib/docker/overlay2/582cdafddd59469191d2155c8dfb6e414fefb2b3ff91ac3c097f9313d3972450/diff/usr/lib/openssh/ssh-keysign
/var/lib/docker/overlay2/582cdafddd59469191d2155c8dfb6e414fefb2b3ff91ac3c097f9313d3972450/diff/bin/mount
/var/lib/docker/overlay2/582cdafddd59469191d2155c8dfb6e414fefb2b3ff91ac3c097f9313d3972450/diff/bin/ping
/var/lib/docker/overlay2/582cdafddd59469191d2155c8dfb6e414fefb2b3ff91ac3c097f9313d3972450/diff/bin/ping6
/var/lib/docker/overlay2/582cdafddd59469191d2155c8dfb6e414fefb2b3ff91ac3c097f9313d3972450/diff/bin/umount
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/usr/bin/gpasswd
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/usr/bin/passwd
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/usr/bin/newgrp
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/usr/bin/chsh
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/usr/bin/chfn
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/bin/su
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/bin/mount
/var/lib/docker/overlay2/9b7c16f4ceb7e3fc4e3ed7618ef3ffbfe8f03abbe646beb8f8907c00b4442481/diff/bin/umount
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/usr/bin/gpasswd
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/usr/bin/passwd
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/usr/bin/newgrp
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/usr/bin/chsh
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/usr/bin/chfn
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/bin/su
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/bin/mount
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/bin/ping
/var/lib/docker/overlay2/649416fd809be1b87847cbc041f9eb007525706f1961c94124155a853c633e36/diff/bin/umount
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/usr/bin/gpasswd
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/usr/bin/passwd
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/usr/bin/newgrp
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/usr/bin/chsh
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/usr/bin/chfn
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/bin/su
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/bin/mount
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/bin/ping
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/bin/ping6
/var/lib/docker/overlay2/2c977f2b9cff6cda91a58f26102c165f8d9431f56147d90559e9cac586afb184/diff/bin/umount
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/usr/bin/gpasswd
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/usr/bin/passwd
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/usr/bin/newgrp
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/usr/bin/chsh
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/usr/bin/chfn
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/bin/su
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/bin/mount
/var/lib/docker/overlay2/2fbe9eb3414a1b39cc3833c21a9f606aecf13c8342d9133247941a315d555e03/diff/bin/umount
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/usr/bin/gpasswd
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/usr/bin/passwd
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/usr/bin/newgrp
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/usr/bin/chsh
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/usr/bin/chfn
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/bin/su
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/bin/mount
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/bin/ping
/var/lib/docker/overlay2/f45c05910c817cf8602c7dfc32ba4d37a14ff812bce4680e3d9c7c1eb26ac775/diff/bin/umount
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/lib/eject/dmcrypt-get-device
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/lib/pt_chown
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/bin/gpasswd
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/bin/passwd
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/bin/newgrp
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/bin/sudo
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/bin/chsh
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/usr/bin/chfn
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/bin/su
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/bin/mount
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/bin/ping
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/bin/ping6
/var/lib/docker/overlay2/122262c92ebb5c7461d47f74a59db9690595a3f224760454f566f22499f906f7/diff/bin/umount
/var/lib/docker/overlay2/a4348bca10f4f5f49ad0cc97fef42867d49efc10ad5d3fd42bf9001a4a5ce984/diff/usr/local/apache2/bin/suexec
/var/lib/docker/overlay2/2b75fa90e91f25f7f3f9f2ea444370ee069a483972aba0692b914ebf6bcb9382/diff/usr/lib/mysql/plugin/auth_pam_tool_dir/auth_pam_tool
/var/lib/docker/overlay2/07e1181b5dbde0d15e34022b20a5af230ddca2ed437b4606836064cb427c3a1b/diff/usr/lib/openssh/ssh-keysign
/home/jane/Documents/ExploitTar/.cache/.cachefile
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/snapd/snap-confine
/usr/lib/xorg/Xorg.wrap
/usr/lib/eject/dmcrypt-get-device
/usr/sbin/pppd
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/traceroute6.iputils
/usr/bin/arping
/usr/bin/sudo
/usr/bin/pkexec
/usr/bin/chsh
/usr/bin/chfn
/sbin/mount.cifs
/bin/su
/bin/mount
/bin/ping
/bin/umount
/bin/fusermount
/snap/core20/1328/usr/bin/chfn
/snap/core20/1328/usr/bin/chsh
/snap/core20/1328/usr/bin/gpasswd
/snap/core20/1328/usr/bin/mount
/snap/core20/1328/usr/bin/newgrp
/snap/core20/1328/usr/bin/passwd
/snap/core20/1328/usr/bin/su
/snap/core20/1328/usr/bin/sudo
/snap/core20/1328/usr/bin/umount
/snap/core20/1328/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1328/usr/lib/openssh/ssh-keysign
/snap/core20/1270/usr/bin/chfn
/snap/core20/1270/usr/bin/chsh
/snap/core20/1270/usr/bin/gpasswd
/snap/core20/1270/usr/bin/mount
/snap/core20/1270/usr/bin/newgrp
/snap/core20/1270/usr/bin/passwd
/snap/core20/1270/usr/bin/su
/snap/core20/1270/usr/bin/sudo
/snap/core20/1270/usr/bin/umount
/snap/core20/1270/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1270/usr/lib/openssh/ssh-keysign
/snap/core/12725/bin/mount
/snap/core/12725/bin/ping
/snap/core/12725/bin/ping6
/snap/core/12725/bin/su
/snap/core/12725/bin/umount
/snap/core/12725/usr/bin/chfn
/snap/core/12725/usr/bin/chsh
/snap/core/12725/usr/bin/gpasswd
/snap/core/12725/usr/bin/newgrp
/snap/core/12725/usr/bin/passwd
/snap/core/12725/usr/bin/sudo
/snap/core/12725/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/12725/usr/lib/openssh/ssh-keysign
/snap/core/12725/usr/lib/snapd/snap-confine
/snap/core/12725/usr/sbin/pppd
/snap/core18/1265/bin/mount
/snap/core18/1265/bin/ping
/snap/core18/1265/bin/su
/snap/core18/1265/bin/umount
/snap/core18/1265/usr/bin/chfn
/snap/core18/1265/usr/bin/chsh
/snap/core18/1265/usr/bin/gpasswd
/snap/core18/1265/usr/bin/newgrp
/snap/core18/1265/usr/bin/passwd
/snap/core18/1265/usr/bin/sudo
/snap/core18/1265/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/1265/usr/lib/openssh/ssh-keysign
/snap/core18/2284/bin/mount
/snap/core18/2284/bin/ping
/snap/core18/2284/bin/su
/snap/core18/2284/bin/umount
/snap/core18/2284/usr/bin/chfn
/snap/core18/2284/usr/bin/chsh
/snap/core18/2284/usr/bin/gpasswd
/snap/core18/2284/usr/bin/newgrp
/snap/core18/2284/usr/bin/passwd
/snap/core18/2284/usr/bin/sudo
/snap/core18/2284/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/2284/usr/lib/openssh/ssh-keysign

Executable Files:
/home/sysadmin/Documents/setup_scripts/sysadmin/day3_stu_setup.sh
/home/instructor/Documents/setup_scripts/sysadmin/day3_stu_setup.sh
/home/instructor/Documents/setup_scripts/instructor/day3_setup.sh

The Top 10 Processes are:
USER PID %CPU %MEM COMMAND
sysadmin 3016 3.7 7.7 /usr/bin/gnome-shell
gdm 2481 1.5 5.1 /usr/bin/gnome-shell
sysadmin 3512 0.7 3.5 /usr/bin/gnome-software
sysadmin 2829 0.9 3.1 /usr/lib/xorg/Xorg
root 1357 0.1 1.8 /usr/bin/dockerd
sysadmin 3310 0.1 1.6 /usr/lib/evolution/evolution-calendar-factory
root 2622 1.5 1.6 /usr/lib/packagekit/packagekitd
sysadmin 3356 0.1 1.5 /usr/lib/evolution/evolution-calendar-factory-subprocess
sysadmin 3244 0.2 1.4 nautilus-desktop
sysadmin 3328 0.5 1.3 /usr/bin/nautilus

The Permissions for sensitive /etc files: 

-rw------- 1 root shadow 2828 Jan 17 22:26 /etc/shadow
-rw-r--r-- 1 root root 3075 Jan 17 22:26 /etc/passwd
-rw-r--r-- 1 root root 228 Nov 12  2019 /etc/hosts

The Date is: Mon Mar 14 21:44:45 EDT 2022

A Full System Scan was Completed!

End of System Info!
